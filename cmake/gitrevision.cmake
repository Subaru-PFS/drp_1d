find_program(GIT git)
if(GIT)
  execute_process(COMMAND ${GIT} rev-parse --short HEAD OUTPUT_VARIABLE GIT_REVISION_UNSTRIPPED)
  string(STRIP ${GIT_REVISION_UNSTRIPPED} GIT_REVISION)
  execute_process(COMMAND ${GIT} status --untracked-files=no --short
    OUTPUT_VARIABLE GIT_UNCOMMITED)
  if(GIT_UNCOMMITED)
    message(STATUS "You have uncommited changes. Using -untracked flag.")
    set(GIT_REVISION "${GIT_REVISION}-untracked")
  endif()
else()
  message(STATUS "git not found. Using 'untracked' revision.")
  set(GIT_REVISION "untracked")
endif()
